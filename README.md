# Helper Tools for Translation Revewer

This set of tools helps someone to review existing 
translations and to find correct locations in translation 
resources of Apache OpenOffice.

There are numerous number of strings in the office UI and 
help files. To find correct string resource for the specific 
resource is little bit difficult without knowledge of the 
source tree of the office.

See each directories if you need details.

## List of Contents

* [Help Location Extension](#help-location-extension)
* [Help with Link to Resource Location](#help-with-link-to-resource-location)
* [Help Viewer Hacker](#help-viewer-hacker)
* [Comment Search Plug-In for OmegaT](#comment-search-plug-in-for-omegat)
* [DB File to Tree](#db-file-to-tree)

## Help Location Extension
This extension allows you to change the place of help files. 
Default help files are placed in OFFICE\_INSTALL/help. This 
tool provides the workaround to avoid to modify the original 
files. 

This tool is useful for the following tools that changes 
original XSLT files.

This package contains only the setting that changes the help 
location to $(userpath)/help. This means the location for 
help files is changed to USER_PROFILE/help. If you want to 
change the location to somewhere else, modify the file. Not 
the location should be system path after the path 
substitution by the special path substitution service.

### Usage
1. Install en-US and your target locale files including help files.
2. Copy original help directory from OFFICE\_INSTALL/help to USER\_PROFILE/help.
3. Install "helplocation.oxt" package through the extension manager.
4. Restart your office.

If you do not need these tools for a while, disable this package 
and the following packages in the extension manager.


## Help with Link to Resource Location
Original help viewer does not show useful information about 
the location in the string resouces. To ease to find the 
correct location for the specific paragraph of the help 
content in the resource, this XSLT filter for XHP file is 
modified to show link to the location. And also some useful 
informations are shown.

Install "helplocation" extension before you to use this filter. 
Links generated by this filter requires the following tools to 
be executed to open as hyper link to web.

It seems the similar filter is attached to issue 56321. 
But this one provides direct link to location of the string resources.

### Usage
1. Replace USER\_PROFILE/help/main_transform.xsl file with downloaded file.
2. Restart your office.

Some links are shown with the original contents of the help. 
Click one of them to open the location of the string.

### Tags
There are some tags are shown with original help content like as [tag]. 
Their meanings are as follows: 

+ [par_id...], means paragraph id.
+ [hd_id...], means heading id.
+ [ahelp], the paragraph is used in the extended tooltip also.
+ [ahelp, hidden], this paragraph is hidden in the help viewer but used in the extended tooltip.
+ [index, hidden], this is the title entry for Index tab in the viewer.


## Help Viewer Hacker
This tool hacks the help viewer. Links provided by the modified filter 
for XHP files require this tool to open. And also, "en" button is added 
to the toolbar of the viewer to open "en" version of the currently opened page 
for your localized one.

### Usage
1. Install "helplocation" and modified filter.
2. Install "hhacker.oxt" package through the extension manager.
3. Restart your office.

Now you can see the following entries in Help - Help Tools in main menu: 

+ Open Help - Pootle Location Search
+ Open Help - OmegaT Location Search

See the following sections for more detail.

### Pootle Location Search
The Pootle server is opened with search query for location option in 
your web browser, when you click links on the viewer opened by this menu entry.

If you need to change the address of the server to open, see 
hhacker directory.

### OmegaT Location Search
When you click the links on the viewer opened by this menu entry, 
the entry for the string is searched in OmegaT. 
This function requires the following plug-in for OmegaT.
See the following section for more detail.

### Open en-US Version of Current Page
"en" button is added to the toolbar of the viewer if you 
open the help viewer through the menu entries provided by 
this tool.


## Comment Search Plug-In for OmegaT
If you translate PO files on OmegaT, try this plug-in to find 
the correct location of the specific string.
This plug-in works with "hhacker" tool.

The plug-in starts HTTP sever to listen for search requests. 
Therefore you can trigger search function from out of the 
OmegaT instance.

And also, the plug-in searches in comments that contains 
location informations about the string resources of the office.

### Get Plug-In
This plug-in is hosted in the another repository [1].

[1] https://github.com/hanya/CommentSearch

### Usage
The plug-in is written in Groovy with OmegaT [2] scripting [3], 
install it if you do not have it. Since OmegaT 3.0.3, the scripting 
plug-in has been integrated, so if you use 3.0.3 or later version, 
you do not need to install it yourself.

1. Make the OmegaT scripting work.
2. Download the plug-in file and put it in some directory.
3. Start OmegaT.
4. Choose Tool - Scripting to open scripting window.
5. Push Choose button to select the directory that you put the plug-in file in.
6. Select the plug-in in the left side of the scripting window and push execute button.

Comment Search window is opened in step 6. You can search in comments 
of entries with the input field and the search button.
Push "Start" button to start your search server. 
Open your project before you use the plug-in.

[2] http://www.omegat.org/

[3] http://sourceforge.net/projects/omegat-plugins/files/OmegaT-Scripting/


## DB File to Tree
In help directory, there is db file containing list of pages that 
can be seen as pages in the help viewer for each subjects or pages.

This small python script read db file and generates tree file which 
provides the tree structure shown in the left side bar of the viewer.

### Usage
 python dbtotree.py -i path\_to\_help\_dir -o path\_to\_output\_dir

Copy generated contents to help direcotry. Restart your office and then 
you can see All node in the help viewer. 
Use Help Location Extension if you needed, see above.


